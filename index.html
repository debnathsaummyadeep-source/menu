<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saummya's Nest - Menu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #D97706;
            --primary-dark: #B45309;
            --secondary: #059669;
            --bg: #FFFBF5;
            --surface: #FFFFFF;
            --text: #1F2937;
            --text-light: #6B7280;
            --border: #E5E7EB;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding-bottom: 120px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 2rem 1.5rem;
            text-align: center;
            box-shadow: var(--shadow-lg);
            position: sticky;
            top: 0;
            z-index: 100;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.95;
            font-weight: 400;
        }

        .loading {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-light);
        }

        .loading-spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid var(--border);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .table-selector {
            background: var(--surface);
            margin: 1.5rem 1rem 1rem;
            padding: 1.25rem;
            border-radius: 16px;
            box-shadow: var(--shadow);
            animation: fadeIn 0.6s ease-out 0.2s both;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .table-selector label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text);
            font-size: 0.95rem;
        }

        .table-selector select {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            transition: all 0.2s;
        }

        .table-selector select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.1);
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .category {
            margin: 2rem 0;
            animation: fadeIn 0.6s ease-out both;
        }

        .category-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--primary);
            display: inline-block;
        }

        .menu-item {
            background: var(--surface);
            border-radius: 16px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            box-shadow: var(--shadow);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid transparent;
            display: flex;
            gap: 1rem;
        }

        .menu-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary);
        }

        .menu-item.unavailable {
            opacity: 0.6;
            background: #F9FAFB;
        }

        .item-image {
            width: 100px;
            height: 100px;
            border-radius: 12px;
            object-fit: cover;
            flex-shrink: 0;
            background: var(--bg);
            border: 2px solid var(--border);
        }

        .item-image-placeholder {
            width: 100px;
            height: 100px;
            border-radius: 12px;
            flex-shrink: 0;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 2px solid var(--primary);
        }

        .item-content {
            flex: 1;
            min-width: 0;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }

        .item-name {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text);
            flex: 1;
        }

        .item-price {
            font-weight: 700;
            font-size: 1.15rem;
            color: var(--primary);
            margin-left: 1rem;
            flex-shrink: 0;
        }

        .item-description {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .quantity-btn {
            width: 36px;
            height: 36px;
            border: 2px solid var(--primary);
            background: var(--surface);
            color: var(--primary);
            border-radius: 8px;
            font-size: 1.25rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .quantity-btn:active {
            transform: scale(0.95);
        }

        .quantity-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .quantity-display {
            font-weight: 600;
            font-size: 1.1rem;
            min-width: 30px;
            text-align: center;
        }

        .add-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.625rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Inter', sans-serif;
        }

        .add-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .add-btn:active {
            transform: translateY(0);
        }

        .add-btn:disabled {
            background: var(--border);
            cursor: not-allowed;
            opacity: 0.5;
        }

        .cart-summary {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--surface);
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 1rem 1.5rem;
            z-index: 1000;
            border-top: 3px solid var(--primary);
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }

        .cart-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .cart-items {
            font-weight: 600;
            color: var(--text);
        }

        .cart-total {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        .checkout-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--secondary) 0%, #047857 100%);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Inter', sans-serif;
            box-shadow: 0 4px 6px rgba(5, 150, 105, 0.2);
        }

        .checkout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(5, 150, 105, 0.3);
        }

        .checkout-btn:active {
            transform: translateY(0);
        }

        .checkout-btn:disabled {
            background: var(--border);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            animation: fadeIn 0.3s ease-out;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--surface);
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.3s ease-out;
        }

        .modal-header {
            font-family: 'Playfair Display', serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .customer-info-section {
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text);
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            transition: all 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-light);
        }

        textarea.form-input {
            resize: vertical;
            min-height: 80px;
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            padding: 0.875rem 0;
            border-bottom: 1px solid var(--border);
        }

        .order-item:last-child {
            border-bottom: none;
        }

        .order-item-details {
            flex: 1;
        }

        .order-item-name {
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.25rem;
        }

        .order-item-qty {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .order-item-price {
            font-weight: 600;
            color: var(--primary);
            margin-left: 1rem;
        }

        .order-total {
            display: flex;
            justify-content: space-between;
            padding: 1.25rem 0;
            margin-top: 1rem;
            border-top: 2px solid var(--primary);
            font-size: 1.25rem;
            font-weight: 700;
        }

        .payment-section {
            margin: 1.5rem 0;
        }

        .payment-label {
            font-weight: 600;
            margin-bottom: 1rem;
            display: block;
            color: var(--text);
        }

        .payment-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .payment-option {
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .payment-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .payment-option.selected {
            border-color: var(--primary);
            background: rgba(217, 119, 6, 0.1);
            box-shadow: 0 0 0 3px rgba(217, 119, 6, 0.1);
        }

        .payment-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }

        .payment-details {
            flex: 1;
        }

        .payment-text {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .payment-subtext {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .transaction-input-group {
            display: none;
            margin-top: 1rem;
        }

        .transaction-input-group.active {
            display: block;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .modal-btn {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Inter', sans-serif;
        }

        .btn-cancel {
            background: var(--border);
            color: var(--text);
        }

        .btn-cancel:hover {
            background: #D1D5DB;
        }

        .btn-confirm {
            background: linear-gradient(135deg, var(--secondary) 0%, #047857 100%);
            color: white;
        }

        .btn-confirm:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(5, 150, 105, 0.2);
        }

        .badge {
            display: inline-block;
            background: var(--secondary);
            color: white;
            padding: 0.25rem 0.625rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .badge-unavailable {
            background: #DC2626;
        }

        .empty-cart {
            text-align: center;
            padding: 2rem;
            color: var(--text-light);
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.75rem;
            }

            .category-title {
                font-size: 1.35rem;
            }

            .modal-content {
                padding: 1.5rem;
            }

            .menu-item {
                flex-direction: column;
            }

            .item-image, .item-image-placeholder {
                width: 100%;
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ü™∫ Saummya's Nest</h1>
        <p>Where Every Bite Feels Like Home</p>
    </div>

    <div class="table-selector">
        <label for="tableNumber">Select Your Table</label>
        <select id="tableNumber">
            <option value="">Choose table...</option>
            <option value="1">Table 1</option>
            <option value="2">Table 2</option>
            <option value="3">Table 3</option>
            <option value="4">Table 4</option>
            <option value="5">Table 5</option>
            <option value="6">Table 6</option>
            <option value="7">Table 7</option>
            <option value="8">Table 8</option>
            <option value="9">Table 9</option>
            <option value="10">Table 10</option>
        </select>
    </div>

    <div class="loading" id="loading">
        <div class="loading-spinner"></div>
        <p>Loading menu...</p>
    </div>

    <div class="container" id="menu-container" style="display: none;">
        <!-- Menu items will be loaded here dynamically -->
    </div>

    <!-- Cart Summary -->
    <div class="cart-summary">
        <div class="cart-info">
            <span class="cart-items"><span id="total-items">0</span> items</span>
            <span class="cart-total">‚Çπ<span id="total-price">0</span></span>
        </div>
        <button class="checkout-btn" id="checkout-btn" onclick="openCheckout()" disabled>
            View Order & Checkout
        </button>
    </div>

    <!-- Checkout Modal -->
    <div class="modal" id="checkout-modal">
        <div class="modal-content">
            <h2 class="modal-header">Your Order</h2>
            
            <!-- Customer Information -->
            <div class="customer-info-section">
                <div class="form-group">
                    <label class="form-label">Your Name *</label>
                    <input type="text" class="form-input" id="customer-name" placeholder="Enter your name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Phone Number *</label>
                    <input type="tel" class="form-input" id="customer-phone" placeholder="+91 98765 43210" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Special Instructions (Optional)</label>
                    <textarea class="form-input" id="special-instructions" placeholder="E.g., Extra spicy, less oil, no onions, etc."></textarea>
                </div>
            </div>

            <div id="order-summary"></div>
            
            <div class="payment-section">
                <label class="payment-label">Select Payment Method</label>
                <div class="payment-options">
                    <div class="payment-option" onclick="selectPayment('cash')">
                        <div class="payment-icon">üíµ</div>
                        <div class="payment-details">
                            <div class="payment-text">Cash at Counter</div>
                            <div class="payment-subtext">Pay when you collect</div>
                        </div>
                    </div>
                    <div class="payment-option" onclick="selectPayment('card')">
                        <div class="payment-icon">üí≥</div>
                        <div class="payment-details">
                            <div class="payment-text">Card/UPI at Counter</div>
                            <div class="payment-subtext">Pay at counter with card/UPI</div>
                        </div>
                    </div>
                    <div class="payment-option" onclick="selectPayment('upi')">
                        <div class="payment-icon">üì±</div>
                        <div class="payment-details">
                            <div class="payment-text">Pay Now (UPI)</div>
                            <div class="payment-subtext">Opens your UPI app automatically</div>
                        </div>
                    </div>
                </div>
                
                <div class="transaction-input-group" id="transaction-input-group">
                    <label class="form-label">Transaction ID / UTR Number *</label>
                    <input type="text" class="form-input" id="transaction-id" placeholder="Enter transaction ID after payment">
                </div>
            </div>

            <div class="modal-buttons">
                <button class="modal-btn btn-cancel" onclick="closeCheckout()">Cancel</button>
                <button class="modal-btn btn-confirm" id="confirm-btn" onclick="confirmOrder()" disabled>
                    Confirm Order
                </button>
            </div>
        </div>
    </div>

    <script>
        // ‚öôÔ∏è CONFIGURATION - CHANGE THESE VALUES
        const CONFIG = {
            // Replace with your Google Sheets Published CSV URL
            SHEET_URL: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRX9W4qfMlqzN7OWeigM2frfdbK3nXGM0LMMZGfvShbCFtwI07OKWfVm6HRqpW6aOmzFn2AaSjmRECW/pub?output=csv',
            
            // Replace with your restaurant's WhatsApp number (with country code, no + sign)
            WHATSAPP_NUMBER: '917363039591',
            
            // Replace with your UPI ID (e.g., yourname@paytm, yourname@phonepe)
            UPI_ID: 'saummyasnest@paytm',
            
            // Your business name for UPI payment
            BUSINESS_NAME: 'Saummyas Nest'
        };

        // Global variables
        let menuData = {};
        let cart = {};
        let selectedPayment = '';
        let quantities = {};

        // Load menu from Google Sheets
        async function loadMenu() {
            try {
                const response = await fetch(CONFIG.SHEET_URL);
                const csvText = await response.text();
                
                // Parse CSV
                const rows = csvText.split('\n').slice(1);
                const categories = {};

                rows.forEach((row, index) => {
                    if (!row.trim()) return;
                    
                    const cols = parseCSVRow(row);
                    
                    // CSV format: Item Name, Category, Price, Description, Image URL, Available
                    const itemName = cols[0];
                    const category = cols[1];
                    const price = parseInt(cols[2]) || 0;
                    const description = cols[3] || '';
                    const imageUrl = cols[4] || '';
                    const available = cols[5]?.toLowerCase() === 'yes';

                    if (!itemName || !category) return;

                    const itemId = `item-${index}`;
                    
                    menuData[itemId] = {
                        name: itemName,
                        price: price,
                        category: category,
                        description: description,
                        imageUrl: imageUrl,
                        available: available
                    };

                    if (!categories[category]) {
                        categories[category] = [];
                    }
                    categories[category].push(itemId);
                    quantities[itemId] = 0;
                });

                renderMenu(categories);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('menu-container').style.display = 'block';

            } catch (error) {
                console.error('Error loading menu:', error);
                document.getElementById('loading').innerHTML = `
                    <div class="loading-spinner"></div>
                    <p style="color: #DC2626;">Failed to load menu. Please refresh the page.</p>
                `;
            }
        }

        function parseCSVRow(row) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < row.length; i++) {
                const char = row[i];
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current.trim());
            return result.map(col => col.replace(/^"|"$/g, ''));
        }

        function renderMenu(categories) {
            const container = document.getElementById('menu-container');
            container.innerHTML = '';

            const categoryEmojis = {
                'Starters': 'ü•ò', 'Main Course': 'üçõ', 'Breads': 'üçû',
                'Rice': 'üçö', 'Beverages': 'ü•§', 'Desserts': 'üç∞'
            };

            const defaultEmojis = ['üçΩÔ∏è', 'üç¥', 'ü•Ñ', 'üçú', 'ü•ó', 'üç≤'];

            Object.keys(categories).forEach((category, idx) => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category';
                categoryDiv.style.animationDelay = `${0.3 + idx * 0.1}s`;

                const emoji = categoryEmojis[category] || 'üçΩÔ∏è';
                categoryDiv.innerHTML = `<h2 class="category-title">${emoji} ${category}</h2>`;

                categories[category].forEach((itemId, itemIdx) => {
                    const item = menuData[itemId];
                    const itemDiv = document.createElement('div');
                    itemDiv.className = `menu-item ${!item.available ? 'unavailable' : ''}`;

                    let imageHTML = '';
                    if (item.imageUrl && item.imageUrl.trim()) {
                        imageHTML = `<img src="${item.imageUrl}" alt="${item.name}" class="item-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                    <div class="item-image-placeholder" style="display: none;">${defaultEmojis[itemIdx % defaultEmojis.length]}</div>`;
                    } else {
                        imageHTML = `<div class="item-image-placeholder">${defaultEmojis[itemIdx % defaultEmojis.length]}</div>`;
                    }

                    itemDiv.innerHTML = `
                        ${imageHTML}
                        <div class="item-content">
                            <div class="item-header">
                                <div class="item-name">
                                    ${item.name}
                                    ${!item.available ? '<span class="badge badge-unavailable">Out of Stock</span>' : ''}
                                </div>
                                <div class="item-price">‚Çπ${item.price}</div>
                            </div>
                            ${item.description ? `<div class="item-description">${item.description}</div>` : ''}
                            <div class="item-footer">
                                <div class="quantity-control">
                                    <button class="quantity-btn" onclick="changeQuantity('${itemId}', -1)" ${!item.available ? 'disabled' : ''}>‚àí</button>
                                    <span class="quantity-display" id="qty-${itemId}">0</span>
                                    <button class="quantity-btn" onclick="changeQuantity('${itemId}', 1)" ${!item.available ? 'disabled' : ''}>+</button>
                                </div>
                                <button class="add-btn" onclick="addToCart('${itemId}')" ${!item.available ? 'disabled' : ''}>
                                    ${item.available ? 'Add to Cart' : 'Unavailable'}
                                </button>
                            </div>
                        </div>
                    `;

                    categoryDiv.appendChild(itemDiv);
                });

                container.appendChild(categoryDiv);
            });
        }

        function changeQuantity(itemId, change) {
            if (!menuData[itemId]?.available) return;
            quantities[itemId] = Math.max(0, quantities[itemId] + change);
            document.getElementById(`qty-${itemId}`).textContent = quantities[itemId];
        }

        function addToCart(itemId) {
            const qty = quantities[itemId];
            if (qty === 0) {
                alert('Please select quantity first');
                return;
            }

            if (!menuData[itemId]?.available) {
                alert('This item is currently unavailable');
                return;
            }

            if (cart[itemId]) {
                cart[itemId] += qty;
            } else {
                cart[itemId] = qty;
            }

            quantities[itemId] = 0;
            document.getElementById(`qty-${itemId}`).textContent = '0';
            updateCartSummary();
            
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '‚úì Added';
            btn.style.background = '#059669';
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = '';
            }, 1000);
        }

        function updateCartSummary() {
            let totalItems = 0;
            let totalPrice = 0;

            for (const [itemId, qty] of Object.entries(cart)) {
                totalItems += qty;
                totalPrice += menuData[itemId].price * qty;
            }

            document.getElementById('total-items').textContent = totalItems;
            document.getElementById('total-price').textContent = totalPrice;
            document.getElementById('checkout-btn').disabled = totalItems === 0;
        }

        function openCheckout() {
            const tableSelect = document.getElementById('tableNumber');
            if (!tableSelect.value) {
                alert('Please select your table number first!');
                tableSelect.focus();
                return;
            }

            let orderHTML = '';
            let totalPrice = 0;

            if (Object.keys(cart).length === 0) {
                orderHTML = '<div class="empty-cart">Your cart is empty</div>';
            } else {
                for (const [itemId, qty] of Object.entries(cart)) {
                    const item = menuData[itemId];
                    const itemTotal = item.price * qty;
                    totalPrice += itemTotal;

                    orderHTML += `
                        <div class="order-item">
                            <div class="order-item-details">
                                <div class="order-item-name">${item.name}</div>
                                <div class="order-item-qty">Quantity: ${qty}</div>
                            </div>
                            <div class="order-item-price">‚Çπ${itemTotal}</div>
                        </div>
                    `;
                }

                orderHTML += `
                    <div class="order-total">
                        <span>Total Amount</span>
                        <span>‚Çπ${totalPrice}</span>
                    </div>
                `;
            }

            document.getElementById('order-summary').innerHTML = orderHTML;
            document.getElementById('checkout-modal').classList.add('active');
        }

        function closeCheckout() {
            document.getElementById('checkout-modal').classList.remove('active');
            selectedPayment = '';
            document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
            document.getElementById('confirm-btn').disabled = true;
            document.getElementById('customer-name').value = '';
            document.getElementById('customer-phone').value = '';
            document.getElementById('special-instructions').value = '';
            document.getElementById('transaction-id').value = '';
            document.getElementById('transaction-input-group').classList.remove('active');
        }

        function selectPayment(method) {
            selectedPayment = method;
            document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            // Show/hide transaction ID field
            if (method === 'upi') {
                document.getElementById('transaction-input-group').classList.add('active');
            } else {
                document.getElementById('transaction-input-group').classList.remove('active');
            }
            
            document.getElementById('confirm-btn').disabled = false;
        }

        function confirmOrder() {
            const customerName = document.getElementById('customer-name').value.trim();
            const customerPhone = document.getElementById('customer-phone').value.trim();
            const tableNumber = document.getElementById('tableNumber').value;
            const specialInstructions = document.getElementById('special-instructions').value.trim();
            
            if (!customerName) {
                alert('Please enter your name');
                document.getElementById('customer-name').focus();
                return;
            }
            
            if (!customerPhone) {
                alert('Please enter your phone number');
                document.getElementById('customer-phone').focus();
                return;
            }
            
            if (!selectedPayment) {
                alert('Please select a payment method');
                return;
            }

            if (selectedPayment === 'upi') {
                // Calculate total
                let totalPrice = 0;
                for (const [itemId, qty] of Object.entries(cart)) {
                    totalPrice += menuData[itemId].price * qty;
                }
                
                // Create UPI deep link
                const upiLink = `upi://pay?pa=${CONFIG.UPI_ID}&pn=${encodeURIComponent(CONFIG.BUSINESS_NAME)}&am=${totalPrice}&cu=INR&tn=${encodeURIComponent('Order from Table ' + tableNumber)}`;
                
                // Open UPI app
                window.location.href = upiLink;
                
                // Show message
                alert('Your UPI app should open now. After paying, please enter the Transaction ID below.');
                return;
            }

            // Send order to WhatsApp
            sendOrderToWhatsApp(customerName, customerPhone, tableNumber, specialInstructions);
        }

        function sendOrderToWhatsApp(customerName, customerPhone, tableNumber, specialInstructions) {
            const transactionId = document.getElementById('transaction-id').value.trim();
            
            if (selectedPayment === 'upi' && !transactionId) {
                alert('Please enter Transaction ID after completing UPI payment');
                return;
            }

            let orderMessage = `ü™∫ *NEW ORDER - Saummya's Nest*%0A`;
            orderMessage += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ%0A`;
            orderMessage += `üë§ Customer: ${customerName}%0A`;
            orderMessage += `üì± Phone: ${customerPhone}%0A`;
            orderMessage += `ü™ë Table: ${tableNumber}%0A`;
            orderMessage += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ%0A%0A`;

            let totalPrice = 0;
            for (const [itemId, qty] of Object.entries(cart)) {
                const item = menuData[itemId];
                const itemTotal = item.price * qty;
                totalPrice += itemTotal;
                orderMessage += `${qty}x ${item.name} - ‚Çπ${itemTotal}%0A`;
            }

            orderMessage += `%0A‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ%0A`;
            orderMessage += `*Total: ‚Çπ${totalPrice}*%0A`;
            orderMessage += `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ%0A%0A`;

            if (specialInstructions) {
                orderMessage += `üìù *Special Instructions:*%0A${specialInstructions}%0A%0A`;
            }

            if (selectedPayment === 'upi' && transactionId) {
                orderMessage += `üí≥ *Payment: PAID ‚úÖ* (UPI)%0A`;
                orderMessage += `Transaction ID: ${transactionId}%0A`;
            } else {
                const paymentMethod = selectedPayment === 'cash' ? 'Cash' : 'Card/UPI';
                orderMessage += `üí≥ *Payment: ${paymentMethod} at Counter*%0A`;
            }

            orderMessage += `%0AThank you! üôè`;

            const whatsappURL = `https://wa.me/${CONFIG.WHATSAPP_NUMBER}?text=${orderMessage}`;
            window.open(whatsappURL, '_blank');

            setTimeout(() => {
                cart = {};
                updateCartSummary();
                closeCheckout();
                if (selectedPayment === 'upi' && transactionId) {
                    alert('Order confirmed! Payment received. Your food will be served shortly.');
                } else {
                    alert('Order sent! Please proceed to counter for payment.');
                }
            }, 500);
        }

        // Load menu on page load
        window.addEventListener('load', loadMenu);
    </script>
</body>
</html>
